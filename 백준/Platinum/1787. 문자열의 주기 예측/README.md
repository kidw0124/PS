# [Platinum II] 문자열의 주기 예측 - 1787 

[문제 링크](https://www.acmicpc.net/problem/1787) 

### 성능 요약

메모리: 6960 KB, 시간: 12 ms

### 분류

KMP(kmp), 문자열(string)

### 문제 설명

<p>알파벳 소문자들로만 이루어진 문자열을 생각하자. 이런 문자열을 읽어 나가다 보면, 문자열의 주기가 예측되는 순간이 있다. 다음과 같은 문자열을 예로 들어 보자.</p>

<pre>a b a b a b a</pre>

<p>이 문자열을 네 번째 문자까지의 문자열 '<code>a b a b</code>'와, 그 뒤에 남은 '<code>a b a</code>'로 나누어 생각해 볼 수 있다. 이렇게 하면 뒤쪽 문자열은 앞쪽 네 개의 문자 중 세 번째 문자까지가 반복되다가 끝나는 꼴이다.</p>

<pre>a b a b a b a</pre>

<p>또한, 여섯 번째 문자까지의 문자열 '<code>a b a b a b</code>'와, 그 뒤에 남은 '<code>a</code>'로 나누어서 생각할 수도 있다. 이 경우에도 뒤쪽 문자열은 앞쪽 문자열이 반복되다가 끝나는 꼴이다.</p>

<p>즉, 예시된 문자열은 '<code>a b a b</code>'혹은, '<code>a b a b a b</code>'가 반복되는 문자열의 일부라고 예상할 수 있는 것이다. 단, 이러한 추정에서 뒤쪽 문자열이 앞쪽 문자열보다 길면 안 된다. 예를 들어 '<code>a b</code>'는 이 문자열의 주기로 예측하기에는 너무 짧다.</p>

<p>이제는 어떤 문자열 S에 대해, 첫 번째 문자부터, i번째 문자까지로 이루어진 부분 문자열 S<sub>i</sub>를 생각해 보자. 모든  각각에 대해, 위에 예시된 것처럼 문자열의 주기를 추정할 수 있다. 우리가 관심 있는 것은 이렇게  각각에 S<sub>i</sub>에 대해 추정할 수 있는 주기 중 가장 긴 것의 길이이다. 이를 P<sub>i</sub>라고 하자. 예시된 문자열에서 P<sub>7</sub>은 4와 6중 최댓값인 6이 된다.</p>

<p>길이가 n인 문자열 S가 주어졌을 때, P<sub>1</sub> + P<sub>2</sub> + ... + P<sub>n</sub>을 구하는 프로그램을 작성하시오.</p>

### 입력 

 <p>첫째 줄에 문자열 S의 길이 n이 주어진다. (1 ≤ n ≤ 1,000,000) 둘째 줄에 문자열 S가 공백 없이 주어진다.</p>

### 출력 

 <p>첫째 줄에, P<sub>1</sub> + P<sub>2</sub> + ... + P<sub>n</sub>의 값을 출력한다.</p>

